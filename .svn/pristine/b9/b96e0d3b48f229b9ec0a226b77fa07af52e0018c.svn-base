/*
 * lib_smartbelt_profile.h
 *
 *  Created on: 2015. 6. 2.
 *      Author: geoyun
 */

#ifndef APPLICATION_SMARTBELT_LIB_SMARTBELT_PROTOCOL_ITF_LIB_SMARTBELT_PROFILE_H_
#define APPLICATION_SMARTBELT_LIB_SMARTBELT_PROTOCOL_ITF_LIB_SMARTBELT_PROFILE_H_

#define SMARTBELT_MODULE_COUNT				4

/* it can be use module location index */
#define	SMARTBELT_PERIPHERAL_PORT_INDEX		PORTC
#define	SMARTBELT_PERIPHERAL_PIN0_INDEX		11
#define	SMARTBELT_PERIPHERAL_PIN0_MASK		(1<<SMARTBELT_PERIPHERAL_PIN0_INDEX)
#define	SMARTBELT_PERIPHERAL_PIN1_INDEX		13
#define	SMARTBELT_PERIPHERAL_PIN1_MASK		(1<<SMARTBELT_PERIPHERAL_PIN1_INDEX)
#define	SMARTBELT_PERIPHERAL_PIN2_INDEX		14
#define	SMARTBELT_PERIPHERAL_PIN2_MASK		(1<<SMARTBELT_PERIPHERAL_PIN2_INDEX)
#define	SMARTBELT_PERIPHERAL_PIN3_INDEX		15
#define	SMARTBELT_PERIPHERAL_PIN3_MASK		(1<<SMARTBELT_PERIPHERAL_PIN3_INDEX)
#define SMARTBELT_PERIPHERAL_ATTR_RISE		(PIO_DEBOUNCE)
#define SMARTBELT_PERIPHERAL_ATTR_FALL		(PIO_DEBOUNCE)
//#define SMARTBELT_PERIPHERAL_ATTR_RISE		(PIO_PULLUP | PIO_DEBOUNCE | PIO_IT_RISE_EDGE)
//#define SMARTBELT_PERIPHERAL_ATTR_FALL		(PIO_PULLUP | PIO_DEBOUNCE | PIO_IT_FALL_EDGE)


/*  */
#define	SMARTBELT_REQUEST_PORT_INDEX		PORTC
#define	SMARTBELT_REQUEST_PIN0_INDEX		0
#define	SMARTBELT_REQUEST_PIN0_MASK			(1<<SMARTBELT_REQUEST_PIN0_INDEX)
#define	SMARTBELT_REQUEST_PIN1_INDEX		1
#define	SMARTBELT_REQUEST_PIN1_MASK			(1<<SMARTBELT_REQUEST_PIN1_INDEX)
#define	SMARTBELT_REQUEST_PIN2_INDEX		2
#define	SMARTBELT_REQUEST_PIN2_MASK			(1<<SMARTBELT_REQUEST_PIN2_INDEX)
#define	SMARTBELT_REQUEST_PIN3_INDEX		3
#define	SMARTBELT_REQUEST_PIN3_MASK			(1<<SMARTBELT_REQUEST_PIN3_INDEX)
#define SMARTBELT_REQUEST_PORT_MASK			(SMARTBELT_REQUEST_PIN0_MASK \
											| SMARTBELT_REQUEST_PIN1_MASK \
											| SMARTBELT_REQUEST_PIN2_MASK \
											| SMARTBELT_REQUEST_PIN3_MASK \
											)
#define SMARTBELT_REQUEST_ATTR				(PIO_PULLUP | PIO_DEBOUNCE )
#define SMARTBELT_REQUEST_ATTR_RISE			(PIO_PULLUP | PIO_DEBOUNCE | PIO_IT_RISE_EDGE)
#define SMARTBELT_REQUEST_ATTR_FALL			(PIO_PULLUP | PIO_DEBOUNCE | PIO_IT_FALL_EDGE)

#define SMARTBELT_ACK_PORT_INDEX			PORTD
#define	SMARTBELT_ACK_PIN_INDEX				24
#define SMARTBELT_ACK_PIN_MASK				(1<<SMARTBELT_ACK_PIN_INDEX)
//#define SMARTBELT_ACK_ATTR					(PIO_PULLUP)
//#define SMARTBELT_ACK_ATTR_RISE				(PIO_PULLUP | PIO_IT_RISE_EDGE)
//#define SMARTBELT_ACK_ATTR_FALL				(PIO_PULLUP | PIO_IT_FALL_EDGE)
#define SMARTBELT_ACK_ATTR					(PIO_PULLUP | PIO_DEBOUNCE)
#define SMARTBELT_ACK_ATTR_RISE				(PIO_PULLUP | PIO_DEBOUNCE | PIO_IT_RISE_EDGE)
#define SMARTBELT_ACK_ATTR_FALL				(PIO_PULLUP | PIO_DEBOUNCE | PIO_IT_FALL_EDGE)
//#define SMARTBELT_ACK_ATTR					(PIO_DEBOUNCE)
//#define SMARTBELT_ACK_ATTR_RISE				(PIO_DEBOUNCE | PIO_IT_RISE_EDGE)
//#define SMARTBELT_ACK_ATTR_FALL				(PIO_DEBOUNCE | PIO_IT_FALL_EDGE)

#define	SMARTBELT_WAKEUP_PORT_INDEX			PORTC
#define	SMARTBELT_WAKEUP_PIN_INDEX			25
#define	SMARTBELT_WAKEUP_PIN_MASK			(1<<SMARTBELT_WAKEUP_PIN_INDEX)
#define SMARTBELT_WAKEUP_ATTR					(PIO_PULLUP | PIO_DEBOUNCE)
#define SMARTBELT_WAKEUP_ATTR_RISE			(PIO_PULLUP | PIO_DEBOUNCE | PIO_IT_RISE_EDGE)
#define SMARTBELT_WAKEUP_ATTR_FALL			(PIO_PULLUP	| PIO_DEBOUNCE | PIO_IT_FALL_EDGE)

/* manager to data transfer */
/* **************************************************************************************************
 | STATE | ID | CMD | LENGH |  DATA 0 | DATA 1 | DATA 2 | DATA 3 | DATA 4 | DATA 5 | DATA 6 | DATA7 |
 ****************************************************************************************************/
#define	SMARTBELT_PACKET_STATE_INDEX		0
#define	SMARTBELT_PACKET_ID_INDEX			1
#define SMARTBELT_PACKET_CMD_INDEX			2
#define	SMARTBELT_PACKET_LENGH_INDEX		3
#define	SMARTBELT_PACKET_DATA0_INDEX		4
#define	SMARTBELT_PACKET_DATA1_INDEX		5
#define	SMARTBELT_PACKET_DATA2_INDEX		6
#define	SMARTBELT_PACKET_DATA3_INDEX		7
#define	SMARTBELT_PACKET_DATA4_INDEX		8
#define	SMARTBELT_PACKET_DATA5_INDEX		9
#define	SMARTBELT_PACKET_DATA6_INDEX		10
#define	SMARTBELT_PACKET_DATA7_INDEX		11
#define SMARTBELT_PACKET_LOCATION			12

#define SMARTBELT_PACKET_DATA_SIZE			8
#define	SMARTBELT_PACKET_TRANSFER_SIZE		SMARTBELT_PACKET_DATA7_INDEX+1
#define SMARTBELT_PACKET_MSG_SIZE			SMARTBELT_PACKET_LOCATION+1
#define	SMARTBELT_MANAGER_COUNT		10
#define	SMARTBELT_MANAGER_SELECT	0
msgq_pt msgTransfer_msgq_pt;

#define SMARTBELT_CMD_WHOAREYOU		0xC0
#define SMARTBELT_CMD_READ			0xC1
#define SMARTBELT_CMD_WRITE			0xC2

/* read packet
 *  - ID
 *  - CMD 		: SMARTBELT_CMD_READ_DATA
 *  - LENGTH 	: 1 ~ 2
 *  - DATA0		: External Device Address
 *  - DATA1		: read packet size
 *  */
#define	SMARTBELT_CMD_READ_DATA		0xF1
/* write packet
 * - ID
 * - CMD		: SMARTBELT_CMD_WRITE_DATA
 * - LENGTH		: 1 ~ 8
 * - DATA0 	~ DATA7
 * */
/* DATA Format is different each case */
#define SMARTBELT_CMD_WRITE_DATA	0xF2

/* unknown module profile */
#define SMARTBELT_UNKNOWN_PERIPHERAL0_INDEX		0
#define SMARTBELT_UNKNOWN_PERIPHERAL1_INDEX		1
#define SMARTBELT_UNKNOWN_PERIPHERAL2_INDEX		2
#define SMARTBELT_UNKNOWN_PERIPHERAL3_INDEX		3

#define SMARTBELT_UNKNOWN_PERIPHERAL0_ID	0xE0
#define SMARTBELT_UNKNOWN_PERIPHERAL1_ID	0xE1
#define SMARTBELT_UNKNOWN_PERIPHERAL2_ID	0xE2
#define SMARTBELT_UNKNOWN_PERIPHERAL3_ID	0xE3
#endif /* APPLICATION_SMARTBELT_LIB_SMARTBELT_PROTOCOL_ITF_LIB_SMARTBELT_PROFILE_H_ */
